<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Frecuencia Central - May Roga LLC</title>
<style>
  body { font-family: Arial, sans-serif; background: #111; color: #fff; margin: 0; padding: 0; }
  header { background: #222; padding: 1rem; text-align: center; font-size: 1.5rem; }
  main { padding: 2rem; max-width: 800px; margin: auto; }
  textarea { width: 100%; height: 100px; margin-bottom: 1rem; padding: 0.5rem; font-size: 1rem; }
  button { padding: 0.5rem 1rem; font-size: 1rem; margin-right: 0.5rem; cursor: pointer; }
  #audio-controls { margin-top: 1rem; }
</style>
</head>
<body>
<header>Frecuencia Central - May Roga LLC</header>
<main>
  <textarea id="userText" placeholder="Escribe algo o habla usando el micr贸fono..."></textarea>
  <div>
    <button id="detectLangBtn">Detectar idioma y hablar</button>
    <button id="speakBtn">Hablar</button>
    <button id="startMicBtn"> Hablar por micr贸fono</button>
  </div>
  <div id="audio-controls"></div>
</main>

<script>
const userText = document.getElementById('userText');
const speakBtn = document.getElementById('speakBtn');
const detectLangBtn = document.getElementById('detectLangBtn');
const startMicBtn = document.getElementById('startMicBtn');

function speak(text, lang = 'es-ES', voiceName = null) {
  if(!window.speechSynthesis) return alert('Tu navegador no soporta SpeechSynthesis');
  window.speechSynthesis.cancel();
  const utter = new SpeechSynthesisUtterance(text.replace(/[\*\(\),]/g,''));
  utter.lang = lang;
  if(voiceName){
    const voices = speechSynthesis.getVoices();
    const v = voices.find(v => v.name === voiceName);
    if(v) utter.voice = v;
  }
  window.speechSynthesis.speak(utter);
}

// Detecci贸n simple de idioma (usa Intl API como aproximaci贸n)
function detectLanguage(text){
  try{
    const lang = new Intl.Locale(navigator.language || 'es').language;
    if(text.match(/[a-zA-Z]/) && !text.match(/[谩茅铆贸煤帽]/i)) return 'en-US';
    return lang || 'es-ES';
  } catch(e){ return 'es-ES'; }
}

// Bot贸n: detectar idioma y hablar
detectLangBtn.addEventListener('click', ()=>{
  const text = userText.value.trim();
  if(!text) return;
  const lang = detectLanguage(text);
  speak(text, lang);
});

// Bot贸n: hablar directamente
speakBtn.addEventListener('click', ()=>{
  const text = userText.value.trim();
  if(!text) return;
  speak(text, 'es-ES');
});

// Bot贸n: usar micr贸fono
startMicBtn.addEventListener('click', ()=>{
  if(!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) return alert('Micr贸fono no soportado');
  const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
  recognition.lang = 'es-ES';
  recognition.interimResults = false;
  recognition.maxAlternatives = 1;
  recognition.start();
  recognition.onresult = (event)=>{
    const speechText = event.results[0][0].transcript;
    userText.value = speechText;
    speak(speechText, detectLanguage(speechText));
  };
  recognition.onerror = (e)=>console.error(e);
});
</script>
</body>
</html>
